const barStackedVertical=()=>{const a=24,e=24,c=24,n=48;let s=0,r=0,i=0,o=0;const l=d3.select(".bar-stack"),d=l.select("svg"),m={};let x;const f=d3.scaleOrdinal().range(["#2A7D97","#DB455E"]),k=()=>{const t=d3.scaleBand().domain(x.map(t=>t.fecha)).paddingInner(.3),a=d3.scaleLinear().domain([0,d3.max(x,t=>t.max+35)]);m.count={x:t,y:a}},u=t=>{i=l.node().offsetWidth,s=i-n-e,r=(o=600)-a-c,d.attr("width",i).attr("height",o);const x="translate("+n+","+a+")",k=d.select(".bar-stack-container");k.attr("transform",x),((t,a)=>{m.count.x.rangeRound([0,t]),m.count.y.range([a,0])})(s,r);const u=l.select(".bar-stack-container-bis"),g=t.columns.slice(1,3);f.domain(g);const h=d3.stack().keys(g)(t),b=u.selectAll(".serie-vertical").data(h).enter().append("g").attr("class","serie-vertical").attr("fill",t=>f(t.key)).selectAll(".bar-vertical").data(function(t){return t}),p=b.enter().append("rect").attr("class","bar-vertical");b.merge(p).attr("x",t=>m.count.x(t.data.fecha)).attr("y",t=>m.count.y(t[1])).attr("height",t=>m.count.y(t[0])-m.count.y(t[1])).attr("width",m.count.x.bandwidth()),(t=>{const a=d3.axisBottom(m.count.x).ticks(5).tickFormat(d3.format("d"));t.select(".axis-x").attr("transform","translate(0,"+r+")").call(a);const e=d3.axisLeft(m.count.y).tickFormat(d3.format("d")).tickPadding(10).ticks(5).tickSizeInner(-s);t.select(".axis-y").call(e)})(k)};function g(a,e,c){for(e=1,t=0;e<c.length;++e)t+=a[c[e]]=+a[c[e]];return a.total=t,a}window.addEventListener("resize",()=>{k(),u(x)}),d3.csv("csv/maximas-minimas.csv",g,(t,a)=>{t?console.log(t):((x=a).forEach(t=>{t.min=t.minimas,t.max=t.maximas,t.fecha=t.fecha}),(()=>{const t=d.select(".bar-stack-container");t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","axis axis-y"),t.append("g").attr("class","bar-stack-container-bis")})(),k(),u(x))})};barStackedVertical();