const maxvul=()=>{const t=24,a=48,e=24,n=24;let o=0,c=0,r=0,s=0;const l=d3.select(".chart-temperature-max"),i=l.select("svg"),d={};let m;const x=m=>{r=l.node().offsetWidth,o=r-n-a,c=(s=200)-t-e,i.attr("width",r).attr("height",s);const x="translate("+n+","+t+")",u=i.select(".chart-temperature-max-container");u.attr("transform",x),(t=>{d.count.x.range([0,t])})(o);const f=l.select(".chart-temperature-max-container-bis").selectAll(".circles-max").data(m),p=f.enter().append("circle").attr("class","circles-max");f.merge(p).attr("cx",t=>d.count.x(t.fecha)).attr("cy",c/2).attr("r",0).transition().delay(function(t,a){return 10*a}).duration(300).attr("r",t=>3*t.total).attr("fill-opacity",.6),(t=>{const a=d3.axisBottom(d.count.x).tickFormat(d3.format("d")).ticks(6).tickPadding(30);t.select(".axis-x").attr("transform","translate(0,"+c/2+")").call(a)})(u)};window.addEventListener("resize",()=>{x(m)}),d3.csv("csv/max-record.csv",(t,a)=>{t?console.log(t):((m=a).forEach(t=>{t.fecha=t.yearmax,t.total=t.totalmax}),(()=>{const t=i.select(".chart-temperature-max-container");t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","chart-temperature-max-container-bis")})(),(()=>{const t=d3.scaleLinear().domain([d3.min(m,function(t){return t.fecha}),d3.max(m,function(t){return t.fecha})]),a=d3.scaleLinear().domain([d3.min(m,t=>t.total),d3.max(m,t=>t.total)]);d.count={x:t,y:a}})(),d3.csv("csv/max-record.csv",(t,a)=>{if(t)console.log(t);else{(m=a).forEach(t=>{t.fecha=t.yearmax,t.total=t.totalmax});const t=[{data:{year:2012},y:100,dy:-50,dx:-52,note:{title:"Entre 2009 y 2018 se establecen el 78% de los récords de máximas",wrap:230,align:"middle"}}].map(t=>(t.subject={radius:4},t));window.makeAnnotations=d3.annotation().annotations(t).type(d3.annotationCalloutCircle).accessors({x:t=>d.count.x(t.year),y:t=>d.count.y(t.total)}).accessorsInverse({year:t=>d.count.x.invert(t.x),total:t=>d.count.y.invert(t.y)}).on("subjectover",function(t){t.type.a.selectAll("g.annotation-connector, g.annotation-note").classed("hidden",!1)}).on("subjectout",function(t){t.type.a.selectAll("g.annotation-connector, g.annotation-note").classed("hidden",!0)}),i.append("g").attr("class","annotation-test").call(makeAnnotations),i.selectAll("g.annotation-connector, g.annotation-note")}}),x(m))})};maxvul();